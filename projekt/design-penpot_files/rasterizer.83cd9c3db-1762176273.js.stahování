(function(){
'use strict';var LNb=function(a){return PENPOT.zu(function(b){var c=new Image;PENPOT.mt(c,"onload",function(){b.next(c);return b.complete()});PENPOT.mt(c,"crossOrigin","anonymous");PENPOT.mt(c,"onerror",function(d){return b.error(d)});PENPOT.mt(c,"onabort",function(){return b.error(PENPOT.Ug("operation aborted",PENPOT.Yg.d_(PENPOT.t([new PENPOT.k(null,3,[PENPOT.$g,PENPOT.Xu,PENPOT.Fm,PENPOT.GWa,PENPOT.Fp,"operation aborted"],null),null])),null))});PENPOT.mt(c,"src",a);return function(){PENPOT.mt(c,
"src","");PENPOT.mt(c,"onload",null);PENPOT.mt(c,"onerror",null);return PENPOT.mt(c,"onabort",null)}})},MNb=function(a,b,c){var d=a/b;return a<b?new PENPOT.z(null,2,5,PENPOT.D,[c,1/d*c],null):new PENPOT.z(null,2,5,PENPOT.D,[c*d,c],null)},ONb=function(a){if(PENPOT.m(NNb.has(a))){var b=NNb.get(a);return PENPOT.Bu(b.text())}return PENPOT.Nu(function(c){return c==null?(0,PENPOT.lv)(a):PENPOT.Qu(function(d){return NNb.set(a,PENPOT.KWa(d,"text/plain"))},PENPOT.Nu(PENPOT.JWa,(0,PENPOT.lv)(PENPOT.kj.b_(c))))},
PENPOT.Pu(function(c){PENPOT.ft("app.rasterizer",PENPOT.Lj)&&PENPOT.it(new PENPOT.Gg(function(){return new PENPOT.z(null,1,5,PENPOT.D,[new PENPOT.z(null,2,5,PENPOT.D,[PENPOT.Fp,"fetching data uri"],null)],null)}),c,"app.rasterizer",PENPOT.Lj,!1);return(0,PENPOT.lv)(null)},PENPOT.Ov(new PENPOT.k(null,5,[PENPOT.Jv,a,PENPOT.Nv,PENPOT.wD,PENPOT.Ik,PENPOT.UA,PENPOT.xr,PENPOT.$Xa,PENPOT.aYa,!0],null))))},PNb=function(a){var b=PENPOT.gv(a,"href");return PENPOT.m(b)?PENPOT.ii(b,"data:")?(0,PENPOT.lv)(a):
PENPOT.Lu(function(c){PENPOT.jv(a,"href",c);return a},ONb(b)):PENPOT.Cu()},QNb=function(a,b){var c=a.documentElement;var d=a.createElementNS("http://www.w3.org/2000/svg","style");PENPOT.hv(d,a.createTextNode(b));return PENPOT.hv(c,d)},RNb=function(a){return PENPOT.Ou(function(b,c){var d=PENPOT.u(c,0,null);c=PENPOT.u(c,1,null);return PENPOT.ni(b,d,c)},a,PENPOT.Nu(function(b){return PENPOT.Lu(function(c){return new PENPOT.z(null,2,5,PENPOT.D,[b,c],null)},ONb(b))},PENPOT.Lu(PENPOT.Nc,PENPOT.Bu(PENPOT.tg(/url\((https?:\/\/[^)]+)\)/,
a)))))},SNb=function(a){return PENPOT.Ru(PENPOT.Nu(function(b){var c=PENPOT.gv(b,"style");return PENPOT.Qu(function(d){return PENPOT.jv(b,"style",d)},RNb(c))},PENPOT.Bu(PENPOT.hXa(a,"[style]"))))},TNb=function(a){return PENPOT.Ru(PENPOT.Nu(function(b){return PENPOT.Qu(function(c){return PENPOT.jXa(b,c)},RNb(PENPOT.iXa(b)))},PENPOT.Bu(PENPOT.hXa(a,"style"))))},UNb=function(a,b){return PENPOT.Eu(PENPOT.Ru(PENPOT.Nu(PNb,PENPOT.Bu(PENPOT.hXa(a,"image")))),PENPOT.Ru(PENPOT.Qu(PENPOT.Ce(QNb,a),RNb(b))),
SNb(a),TNb(a),(0,PENPOT.lv)(a))},VNb=function(a){return(new DOMParser).parseFromString(a,"image/svg+xml")},WNb=function(a){a=a.documentElement;return(new XMLSerializer).serializeToString(a)},XNb=function(a,b,c){a=VNb(a);return PENPOT.Lu(WNb,PENPOT.Lu(function(d){var e=d.documentElement;var f=d.documentElement;var h=PENPOT.gv(f,"width");f=PENPOT.gv(f,"height");PENPOT.moa(h,f)?(f=d.documentElement,h=PENPOT.gv(f,"width"),f=PENPOT.gv(f,"height"),h=MNb(PENPOT.Wi(h,0),PENPOT.Wi(f,0),c)):(h=PENPOT.gv(d.documentElement,
"viewBox"),typeof h==="string"?(f=PENPOT.oi(h,/\s+/),PENPOT.u(f,0,null),PENPOT.u(f,1,null),h=PENPOT.u(f,2,null),f=PENPOT.u(f,3,null),h=MNb(PENPOT.Wi(h,0),PENPOT.Wi(f,0),c)):h=null);f=h;h=PENPOT.u(f,0,null);f=PENPOT.u(f,1,null);PENPOT.jv(e,"width",""+(h??""));PENPOT.jv(e,"height",""+(f??""));return d},UNb(a,b)))},YNb=function(a){return PENPOT.zu(function(b){var c=PENPOT.bB.createElement("canvas");c.width=a.width;c.height=a.height;c.getContext("bitmaprenderer").transferFromImageBitmap(a);c.toBlob(function(d){b.next(d);
return b.complete()});return PENPOT.Be(null)})},ZNb=function(a){var b=a.data,c=a.styles,d=PENPOT.Cp.a_(a.width,300),e=PENPOT.Cp.a_(a.quality,"medium");return PENPOT.Nu(function(f){return PENPOT.Qu(function(){return PENPOT.LWa(f)},PENPOT.Nu(function(h){var l={resizeWidth:d,resizeQuality:e};var n=h.width;var v=h.height;if("OffscreenCanvas"in window)n=new OffscreenCanvas(n,v);else{var A=document.createElement("canvas");PENPOT.mt(A,"width",n);PENPOT.mt(A,"height",v);n=A}n.getContext("2d").drawImage(h,
0,0);return createImageBitmap(n,l)},LNb(f)))},PENPOT.Lu(PENPOT.MWa,PENPOT.Lu(function(f){return PENPOT.KWa(f,"image/svg+xml")},XNb(b,c,d))))},cOb=function(a){var b=a.data;if(PENPOT.ii($Nb,a.origin)){var c=b.id;a=b.payload;b=b.scope;if(a!=null&&PENPOT.r.a_(b,"penpot/rasterizer")){b=PENPOT.Ce(aOb,c);c=PENPOT.Ce(bOb,c);a:switch(PENPOT.Cp.a_(a.result,"blob")){case "image-bitmap":a=ZNb(a);break a;default:a=PENPOT.Nu(YNb,ZNb(a))}a=PENPOT.uWa(a,b,c)}else a=null;return a}return null},dOb=function(a,b,c){a=
{id:a,type:b,scope:"penpot/rasterizer",payload:c};return window===parent?null:c instanceof ImageBitmap?parent.postMessage(a,$Nb,[c]):parent.postMessage(a,$Nb)},aOb=function(a,b){return dOb(a,"success",b)},bOb=function(a,b){return dOb(a,"failure",PENPOT.Xg(b))},fOb=function(){window.addEventListener("message",cOb);dOb(null,"ready",null);PENPOT.ft("app.rasterizer",PENPOT.ij)&&PENPOT.it(new PENPOT.Gg(function(){return new PENPOT.z(null,3,5,PENPOT.D,[new PENPOT.z(null,2,5,PENPOT.D,[PENPOT.Fp,"initialized"],
null),new PENPOT.z(null,2,5,PENPOT.D,[PENPOT.nAb,""+(PENPOT.rt??"")],null),new PENPOT.z(null,2,5,PENPOT.D,[eOb,""+($Nb??"")],null)],null)}),null,"app.rasterizer",PENPOT.ij,!1);return null},eOb=new PENPOT.x(null,"parent-uri","parent-uri",-371819908);PENPOT.Sa("rasterizer");PENPOT.et.set("app.rasterizer",PENPOT.dt(PENPOT.ij));var NNb=new Map,$Nb=""+(PENPOT.rt??"");PENPOT.na("app.rasterizer.init",fOb);PENPOT.cb();fOb();
}).call(this);
//# sourceMappingURL=rasterizer.83cd9c3db-1762176273.js.map
